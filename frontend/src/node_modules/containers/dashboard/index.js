import React, {Component} from 'react'
import {connect} from 'react-redux'
import {
    fetchUsers,createUser
} from 'actions'

class Dashboard extends Component {
    constructor (props) {
        super(props)
        this.state = {
            userName: ''
        };
        this.handleChangeName = this.handleChangeName.bind(this);
        this.handleChangePass = this.handleChangePass.bind(this);
        this.handleChangeEmail = this.handleChangeEmail.bind(this);
        this.onUserCreate = this.onUserCreate.bind(this);
        this.onUserLogin = this.onUserLogin.bind(this);
    }

    onUserLogin(){
        console.log("LogIn");
        console.log(this.state.loginEmail);
        console.log(this.state.loginPassword);
    }
    handleChangePassLogin(event){
        this.setState({
            loginPassword: event.target.value
        });
    }
    handleChangeEmailLogin(event){
        this.setState({
            loginEmail: event.target.value
        });
    }
    componentDidMount () {
        this.props.fetchUsers();
    }
    handleChangeName(event) {
        this.setState({
            userName: event.target.value
        });
    }
    handleChangePass(event) {
        this.setState({
            email: event.target.value
        });
    }
    handleChangeEmail(event) {
        this.setState({
            pass: event.target.value
        });
    }
     onFormSubmit(event){
        console.log(event);
    }
    onUserCreate(){
        console.log(this.state.userName);
        this.props.createUser(
            {
                userName: this.state.userName,
                email: this.state.email,
                pass: this.state.pass
            }
        );
        this.props.fetchUsers();
        this.state = {
            userName: '',
            email: '',
            pass: ''
        };
    }
    render () {
        let listItems = [];
        if(this.props.state.users.length  > 0){
            listItems = this.props.state.users.map((user) =>
                <li key={user._id}>
                    <span> id - {user._id}</span>
                    <span> role - {user.role}</span>
                    <span> email - {user.email}</span>
                    <span> name - {user.name}</span>
                    <span> pass - {user.pass}</span>
                </li>
            );
        }
        return (
            <main className='dashboard-page'>
                <div className='col-md-6' >
                    <h1>User - {this.state.userName || 'none'}</h1>
                    <form onSubmit={this.onFormSubmit}>
                        <label for="userName">UserName</label>
                        <br/>
                        <input id="userName" className="input" type='text' value={this.state.userName} onChange={this.handleChangeName} />
                        <br/>
                        <label for="email">Email</label>
                        <br/>
                        <input id="email" className="input" type='text' value={this.state.pass} onChange={this.handleChangeEmail} />
                        <br/>
                        <label for="pass">Password</label>
                        <br/>
                        <input id="pass" className="input" type='text' value={this.state.email} onChange={this.handleChangePass} />
                        <button type='submit'>dsfsdf</button>
                    </form>
                    <button onClick={this.onUserCreate} className="btn">Create new user</button>
                    <ul>
                        {listItems}
                    </ul>
                </div>
                <div className='col-md-6'>
                    <form>
                        <label for="email">Email</label>
                        <br/>
                        <input id="email" className="input" type='text' value={this.state.loginEmail} onChange={this.handleChangeEmailLogin} />
                        <br/>
                        <label for="pass">Password</label>
                        <br/>
                        <input id="pass" className="input" type='text' value={this.state.loginPassword} onChange={this.handleChangePassLogin} />
                    </form>
                    <button onClick={this.onUserLogin} className="btn">Create new user</button>
                </div>

            </main>

        )
    }
}

const mapStateToProps = (state, ownProps) => {
    return {
        state: state,
        ownProps: ownProps
    }
};

const mapDispatchToProps = {
    fetchUsers,
    createUser

};

export default connect(mapStateToProps, mapDispatchToProps)(Dashboard)