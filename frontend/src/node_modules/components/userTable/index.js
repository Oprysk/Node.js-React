import React, {Component} from 'react'
import {connect} from 'react-redux'
import {withRouter} from 'react-router'
import {compose} from 'redux'

import Table, { TableBody, TableCell, TableHead, TableRow } from 'material-ui/Table';
import Paper from 'material-ui/Paper';
import {deleteUser, fetchUsers} from 'actions'
import IconButton from 'material-ui/IconButton';
import DeleteIcon from 'material-ui-icons/Delete';
import Spinner from 'components/spinner'
import  LoginForm from 'components/loginForm'

class UserTable extends Component {
    constructor (props) {
        super(props);
        this.state = {};
        this.props.fetchUsers();
    }
    render () {
        let tableRows = [];
        console.log('alert');
        console.log(this.props.state.users);

        if(this.props.state.users.data.length  > 0){
            tableRows = this.props.state.users.data.map((user) =>
            <TableRow key={user._id}>
                <TableCell>{user.userName}</TableCell>
                <TableCell>{user.email}</TableCell>
                <TableCell>{user.role}</TableCell>
                <TableCell numeric>
                        <IconButton aria-label="Delete">
                            <DeleteIcon onClick={() =>  this.props.deleteUser(user)}   />
                        </IconButton>
                </TableCell>
            </TableRow>
            );
        }


        // if(true){
        //     console.log('children LoginForm');
        //     console.log(LoginForm);
        //     return (
        //         <div>
        //         <LoginForm />
        //         <Spinner  component={LoginForm} />
        //         </div>
        //     );
        // }
        return (
            <div>


            <Paper style={{margin:"30px 0px"}}>
                <Table className={'table-font'}>
                    <TableHead>
                        <TableRow>
                            <TableCell>Name</TableCell>
                            <TableCell>Email</TableCell>
                            <TableCell>Role</TableCell>
                            <TableCell> </TableCell>
                        </TableRow>
                    </TableHead>
                    <TableBody>
                        {tableRows}
                    </TableBody>
                </Table>
            </Paper>
               </div>
        )
    }
}
const mapStateToProps = (state, ownProps) => {
    console.log('sadasdasds');
    console.log(state);
    console.log(ownProps);
    return {
        state: state,
        ownProps: ownProps
    }
};

const mapDispatchToProps = {
    deleteUser,
    fetchUsers
};
export default compose(
    withRouter,
    connect(mapStateToProps, mapDispatchToProps)
)(UserTable)